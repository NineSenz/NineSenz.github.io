(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{464:function(s,a,n){"use strict";n.r(a);var t=n(2),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一、运维自动化平台介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、运维自动化平台介绍"}},[s._v("#")]),s._v(" 一、运维自动化平台介绍")]),s._v(" "),a("h3",{attrs:{id:"_1-1、自动化运维平台介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、自动化运维平台介绍"}},[s._v("#")]),s._v(" 1.1、自动化运维平台介绍")]),s._v(" "),a("p",[s._v("运维自动化平台是由管理机器[S]和业务机器[C]组成的,C/S。")]),s._v(" "),a("p",[s._v("管理机器：任务定制及发布；")]),s._v(" "),a("p",[s._v("业务机器：接收任务并执行任务。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/6/1601965978453.png",alt:"运维自动化平台组成.png"}})]),s._v(" "),a("h3",{attrs:{id:"_1-2、运维自动化平台的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、运维自动化平台的优势"}},[s._v("#")]),s._v(" 1.2、运维自动化平台的优势：")]),s._v(" "),a("ul",[a("li",[s._v("一次性任务定制：任务一次性发布给所有机器")]),s._v(" "),a("li",[s._v("节省任务执行时间：任务主机并发完成任务，节省部署时间")]),s._v(" "),a("li",[s._v("错误率低：避免重复，保证一次任务定制准确即可")])]),s._v(" "),a("h2",{attrs:{id:"二、常见的自动化运维工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、常见的自动化运维工具"}},[s._v("#")]),s._v(" 二、常见的自动化运维工具")]),s._v(" "),a("h3",{attrs:{id:"_2-1、常见的运维自动化工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、常见的运维自动化工具"}},[s._v("#")]),s._v(" 2.1、常见的运维自动化工具")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("Puppet")])]),s._v(" "),a("li",[a("strong",[s._v("Ansible")])]),s._v(" "),a("li",[a("strong",[s._v("SaltStack")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("puppet：\n基于Ruby开发，有产品线已经在用，优点是历史悠久，比较成熟，在可远程可本地，功能强劲，批量执行需要写专门的配置文件，费力费时。而且有客户端在，和授权系统结合比较麻烦。\n\nsaltstack:\nsaltstack和ansible都是python流的，而且就功能上来讲，两者也极为相似，不同之处是salt stack是有客户端的，并且execution模块还用0MQ实现了pub-sub，命令和执行结果因此可以高效并行传输，不过成也萧何败也萧何，第一个sub阶段（将querystring下发到所有机器，然后收集机器响应的阶段）太依赖与客户端返回了，如果客户端未能及时返回或未响应的话，playbook执行阶段可能会直接漏掉这部分机器而没有任何提示，这对于运维来说是不可接受的。\n\nansible:\n与前两者比起来，在特性上似乎并不抢眼，配置管理方面（playbook）绝对比不过老大哥puppet，批量执行方面也只是多线程，不像saltstack那么高大上，不过ansible搜索热度高出saltstack三倍多，显然靠的不是吹牛，至少，ansible至少不会悄悄的丢机器，这给了我们一个定心丸，而且仅依赖ssh，与登录授权管理系统天然集成，简单即有效，没有比这更美妙的事情了。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"_2-2、ansible介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、ansible介绍"}},[s._v("#")]),s._v(" 2.2、ansible介绍")]),s._v(" "),a("p",[s._v("ansible是一种由Python开发的自动化运维工具，集合了众多运维工具（puppet、cfengine、chef、func、fabric）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。"),a("strong",[s._v("ansible是基于模块工作的，本身没有批量部署的能力")]),s._v("。"),a("strong",[s._v("真正具有批量部署的是ansible所运行的模块，ansible只是提供一种框架")]),s._v("。主要包括：")]),s._v(" "),a("ol",[a("li",[s._v("连接插件connection plugins：负责和被监控端实现通信；"),a("strong",[s._v("ansible管理端和客户端基于ssh协议通信")])]),s._v(" "),a("li",[s._v("host inventory：指定操作的主机，是一个配置文件里面定义监控的主机；"),a("strong",[s._v("提供主机管理列表，定义管理谁")])]),s._v(" "),a("li",[s._v("各种模块核心模块、command模块、自定义模块；"),a("strong",[s._v("提供了日常模块")])]),s._v(" "),a("li",[s._v("借助于插件完成记录日志邮件等功能； "),a("strong",[s._v("根据需求后续添加模块，邮件、日志模块")])]),s._v(" "),a("li",[s._v("playbook：剧本执行多个任务时，非必需可以让节点一次性运行多个任务。"),a("strong",[s._v("一次发布多条指令给客户端")])])]),s._v(" "),a("p",[a("strong",[s._v("特性")])]),s._v(" "),a("ol",[a("li",[s._v("no agents：不需要在被管控主机上安装任何客户端；")]),s._v(" "),a("li",[s._v("no server：无服务器端，使用时直接运行命令即可；")]),s._v(" "),a("li",[s._v("modules in any languages：基于模块工作，可使用任意语言开发模块；")]),s._v(" "),a("li",[s._v("yaml，not code：使用yaml语言定制剧本playbook；")]),s._v(" "),a("li",[s._v("ssh by default：基于SSH工作；")]),s._v(" "),a("li",[s._v("strong multi-tier solution：可实现多级指挥。")])]),s._v(" "),a("p",[a("strong",[s._v("优点")])]),s._v(" "),a("ol",[a("li",[s._v("轻量级，无需在客户端安装agent，更新时，只需在操作机上进行一次更新即可；")]),s._v(" "),a("li",[s._v("批量任务执行可以写成脚本，而且不用分发到远程就可以执行；")]),s._v(" "),a("li",[s._v("使用python编写，维护更简单，ruby语法过于复杂；")]),s._v(" "),a("li",[s._v("支持sudo")])]),s._v(" "),a("p",[a("strong",[s._v("基本架构")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/6/1601966026674.png",alt:"ansible3.png"}})]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("· 核心引擎：即ansible\n· 核心模块（core modules）：这些都是ansible自带的模块，ansible模块资源分发到远程节点使其执行特定任务或匹配一个特定的状态。\n· 自定义模块（custom modules）：如果核心模块不足以完成某种功能，可以添加自定义模块。\n· 插件（plugins）：完成模块功能的补充，借助于插件完成记录日志、邮件等功能\n· 剧本（playbook）：定义ansible任务的配置文件，可以将多个任务定义在一个剧本中，由ansible自动执行，剧本执行支持多个任务，可以由控制主机运行多个任务，同时对多台远程主机进行管理。\n· playbook是ansible的配置、部署和编排语言，可以描述一个你想要的远程系统执行策略，或一组步骤的一般过程。如果ansible模块作为你的工作室工具，playbook就是设计方案。在基本层面上，剧本可以用于管理配置和部署远程机器。在更高级的应用中，可以序列多层应用及滚动更新，并可以把动作委托给其他主机，与监控服务器和负载平衡器交互。\n· 连接插件（connection plugins）：ansible基于连接插件连接到各个主机上，负责和被管理节点实现通信。虽然ansible是使用ssh连接到各被管理节点，但它还支持其他的连接方法，所以需要有连接插件。\n· 主机清单（host inventory）：定义ansible管理的主机策略，默认是在ansible的hosts配置文件中定义被管节点，同时也支持自定义动态主机清单和指定配置文件路径。\n \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("ansible采用paramiko协议库（Fabric也使用这个，基于python开发，支持SSHV2），通过ssh或者ZeroMQ等连接主机。ansible在控制主机主机将ansible模块通过ssh协议（或者Kerberos、LDAP）推送到被管节点执行，执行完之后自动删除。控制主机与被管理节点之间支持local、SSH、ZeroMQ三种连接方式，默认使用基于SSH的连接。在规模较大的情况下使用ZeroMQ连接方式会明显改善执行速度。")]),s._v(" "),a("h2",{attrs:{id:"三、ansible运行原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、ansible运行原理"}},[s._v("#")]),s._v(" 三、ansible运行原理")]),s._v(" "),a("p",[s._v("ansible是如何工作的呢？我们通过一个图片来说明一下")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/6/1601966060853.png",alt:"ansible工作原理1132928.png"}})]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("工作原理：\n1、用户登录管理机器：通过ansible剧本或者单行命令针对业务机器组或者单个机器部署任务\n\n2、管理机器读取用户的部署任务：根据自己hosts文件中定义的业务机器组查找对应的机器地址(ip或者域名)\n\n3、管理机下发任务：管理机通过ssh免密连接业务机器，下发任务给业务机器\n\n4、业务机器执行任务\n\n5、业务机器将执行结果发送给ansible管理机器\n\t反馈字体颜色\n\t绿色  未发生变化\n\t黄色  更改生效\n\t红色  执行错误\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"四、学习视频"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、学习视频"}},[s._v("#")]),s._v(" 四、学习视频")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.bilibili.com/video/BV19J41167sM/",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频：ansible课程介绍"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV19J41167sM?p=2",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频：自动化运维平台课程介绍"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV19J41167sM?p=3",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频：自动化运维平台介绍"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV19J41167sM?p=4",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频：ansible介绍"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV19J41167sM?p=5",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频：ansible工作原理"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);